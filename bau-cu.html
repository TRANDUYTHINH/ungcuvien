<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Báº§u Cá»­ CLB VÄƒn Nghá»‡</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>ğŸ—³ï¸ Báº¦U Cá»¬ CHá»¨C Vá»¤ CHá»¦ NHIá»†M</h1>

    <div id="alreadyVoted" style="display:none; color: red; font-weight: bold; margin-bottom: 20px;">
      âš ï¸ Báº¡n Ä‘Ã£ báº§u rá»“i. Má»—i ngÆ°á»i chá»‰ Ä‘Æ°á»£c báº§u 1 láº§n.
    </div>

    <form id="voteForm">
      <label><input type="radio" name="vote" value="Nguyá»…n VÄƒn A"> Nguyá»…n VÄƒn A</label><br>
      <label><input type="radio" name="vote" value="Tráº§n Thá»‹ B"> Tráº§n Thá»‹ B</label><br>
      <label><input type="radio" name="vote" value="LÃª VÄƒn C"> LÃª VÄƒn C</label><br>
      <button type="submit">Gá»­i phiáº¿u báº§u</button>
    </form>

    <h2>Káº¿t quáº£ hiá»‡n táº¡i:</h2>
    <ul id="results"></ul>

    <div style="margin-top: 20px; text-align: center;">
      <button onclick="goBack()">ğŸ”™ Quay láº¡i</button>
    </div>

    <script>
      const voteKey = 'votes';
      const votedKey = 'hasVoted';
      const resultEl = document.getElementById("results");
      const form = document.getElementById("voteForm");
      const alreadyVotedMsg = document.getElementById("alreadyVoted");

      function renderResults() {
        const data = JSON.parse(localStorage.getItem(voteKey) || '{}');
        const output = Object.entries(data)
          .map(([name, count]) => `<li><b>${name}</b>: ${count} phiáº¿u</li>`)
          .join('');
        resultEl.innerHTML = output || "<li>ChÆ°a cÃ³ ai báº§u.</li>";
      }

      function checkIfVoted() {
        const hasVoted = localStorage.getItem(votedKey);
        if (hasVoted) {
          form.style.display = "none";
          alreadyVotedMsg.style.display = "block";
        }
      }

      form.addEventListener("submit", function(e) {
        e.preventDefault();
        const selected = document.querySelector('input[name="vote"]:checked');
        if (!selected) {
          alert("Vui lÃ²ng chá»n má»™t á»©ng viÃªn.");
          return;
        }

        const name = selected.value;
        const data = JSON.parse(localStorage.getItem(voteKey) || '{}');
        data[name] = (data[name] || 0) + 1;
        localStorage.setItem(voteKey, JSON.stringify(data));
        localStorage.setItem(votedKey, "true");

        alert("âœ… Báº¡n Ä‘Ã£ báº§u cho " + name);
        form.style.display = "none";
        alreadyVotedMsg.style.display = "block";
        renderResults();
      });

      function goBack() {
        history.length > 1 ? history.back() : location.href = "index.html";
      }

      renderResults();
      checkIfVoted();
    </script>
  </div>
</body>
</html>
